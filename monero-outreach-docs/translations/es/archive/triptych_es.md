# Triptcyh: Un nuevo algoritmo que protege a los usuarios de Monero

**“Monero oculta al emisor, al receptor y la cantidad en una transacción. Triptych (pronunciado trip-tic) es una actualización para Monero que es más rápida, ligera y privada.” - 1 de septiembre, 2020**

Detrás de los detalles en cómo Monero oculta al emisor, al receptor y la cantidad en una transacción, existe un funcionamiento en constante evolución. Este artículo habla sobre Triptych (pronunciado trip-tic), una tecnología nueva de Monero que oculta mejor al emisor usando menos espacio de la cadena de bloques y un menor tiempo en el procesamiento.

### _Firmas de anillo_

Ocultar a quien envía en Monero toma más que tan solo proteger direcciones. Todo dentro de la cadena de bloques de Monero se representa como transacciones salientes u outputs, llamados TXO. Cada TXO está etiquetado con un número de identificación único o ID, que se utiliza una sola vez, llamada llave pública o dirección oculta (stealth address). Con tan solo observar la cadena de bloques, las llaves públicas TXO no pueden ser enlazadas con direcciones de Monero. Sin embargo, las llaves públicas sí necesitan protección. Sería inaceptable para el flujo de Monero que estás llaves fuesen transparentes teniendo en cuenta que pudieran existir técnicas externas a la cadena de bloques que conectaran esas llaves a personas.

El movimiento entre llaves públicas en Monero se mantiene en secreto usando lo que llamamos firmas de anillo criptográficas. Una llave pública para una TXO actual, se oculta agrupándola con señuelos o decoys (también llamados mixins). Cuando miramos una transacción, no hay posibilidad de determinar si un TXO verdadero está siendo usado o si es uno de los señuelos. Puedes ver el ejemplo de entradas y salidas de TXOs mirando una transacción en un explorador de la cadena de bloques de Monero, tal como [moneroblocks.info](https://moneroblocks.info/) or [xmrchain.net](https://xmrchain.net/).

La manera como se seleccionan los señuelos de una TXO desde la cadena de bloques ha mejorado a través de los años. Al principio, como una parte integral del protocolo, los señuelos eran opcionales. Con el tiempo, el número de señuelos se incrementó y el requerimiento de exactamente 10 señuelos al día de hoy es por mandato. Además, los señuelos eran muestreados aleatoriamente y distribuidos de manera uniforme por todas las transacciones en las primeras versiones estándar del monedero. El proceso de muestreo mejoró con el tiempo hasta llegar al proceso aleatorio personalizado que tenemos hoy basado en la selección de tiempos desde una distribución gamma.

Los principales algoritmos de las firmas de anillo también han mejorado. El libro blanco de CryptoNote entregó un esquema de firmas de anillos diferente de la actual implementación, basada en firmas con mayor eficiencia de un Grupo Anónimo Multicapa de Vinculación Espontánea (MLSAG por sus siglas en inglés). Una actualización esperada llamada firmas de Grupo Anónimo Conciso de Vinculación Espontánea (CLSAG por sus siglas en inglés) viene en camino y se espera que haga una reducción adicional al tamaño de las transacciones de un cuarto del tamaño actual, y una reducción de verificación en los tiempos por casi una décima parte (para una transacción de dos entradas, dos salidas).

Todas estás actualizaciones le han dan a Monero un anonimato único. Cada TXO real, desconectada criptográficamente de la dirección del remitente, que se gasta en la forma de una llave pública TXO, se oculta entre 10 llaves señuelo públicas seleccionadas en la cadena de bloques para parecerse a las reales. Esto frustra a quienes buscan vigilar y rastrear transacciones en Monero. Todo esto sucede al mismo tiempo que el software de Monero se ejecuta de manera rápida y sin interrupciones, dando una velocidad óptima y un tamaño de cadena de bloques razonable.

### _Desafíos_

Ocultar al remitente en Monero no es perfecto. Diez señuelos no siempre son suficientes, ya que algún TXO aleatorio puede ser identificable. Puede que, con conocimiento público, los TXO, hayan sido utilizados en algún otro gasto. La existencia de las listas negras o blacklists muestra que esto puede ser un problema potencial y les da una solución a aquellos que estén motivados a esquivar y a agregar esta lista en sus monederos. Existen otras maneras de identificar los señuelos en una transacción, como por ejemplo, atar los TXO de los pools y los TXO de las casas de cambio, estimando su validez en otras transacciones y utilizando tiempos de probabilidad.

Imagina un alineamiento policial con un acusado injustamente y 10 señuelos. Si los señuelos fueran conocidos a un testigo falso, no serviría de nada proteger al acusado. Esto también se confirma con las firmas de anillo de Monero; ocultarse entre señuelos solo sirve cuando los señuelos son extraños y, para algunos adversarios, en particular adversarios con recursos, solo 10 señuelos aleatorios pueden ser insuficiente. Y entonces, ¿por qué no usar más?

Bueno, para el algoritmo MLSAG/CLSAG utilizado por Monero, tanto el tamaño de la transacción como el tiempo para procesarla crecen linealmente con la cantidad de señuelos (según su complejidad algorítmica Big O). La utilización de diez señuelos compensa la necesidad de privacidad con la necesidad de una cadena de bloques pequeña y un procesamiento más rápido. Incrementar el número de señuelos puede ayudar a mejorar la privacidad, pero también incrementa el tamaño de la transacción, que de por sí ya es un poco más grande que las transacciones de Bitcoin, y ralentizar la validación de los monederos.

### _Triptych_

Abordando este desafío encontramos a Triptych, un nuevo algoritmo para las firmas de anillo desarrollado por Sarang Noether y Brandon Goodell del Laboratorio de Investigación de Monero, con la asociación externa de Arthur Blue (RandomRun). Con Triptych el tamaño de las firmas de anillo crece de manera logarítmica en vez de lineal. El crecimiento logarítmico, es muy lento, además, es el patrón de crecimiento mejor conocido sin recurrir en la necesidad de confiar en alguien para usar y luego destruir la aleatoriedad durante su configuración (tal como fue hecho para Zcash). En Triptych, los tiempos de verificación aún crecen linealmente con el número de señuelos, pero la verificación puede agruparse y evaluarse utilizando algoritmos especializados los cuales ofrecen algo de aceleración.

Triptych supera varios desafíos para la aplicación de las firmas de anillos en Monero. Provee de vinculación. La técnica de las firmas de anillo en Monero tiene que bloquear la reutilización de llaves públicas legítimas para impedir gastar un TXO más de una vez (lo que conocemos como doble gasto). Triptych hace esto utilizando etiquetas vinculables que son similares a las llaves de imagen que se utilizan hoy y también integra las transacciones confidenciales que ocultan las cantidades en Monero. Datos especiales llamados llaves de compromiso permiten comprobar que las cantidades de Monero en una transacción son reales sin revelarlas. Las llaves de compromiso con las llaves de firma y las etiquetas vinculadas son los tres componentes que originan el nombre Triptych, que significa algo de tres partes.

### _Probando alternativas_

En la práctica Triptych se ejecuta rápido. Sarang Noether, uno de los creadores, reportó que al momento de las pruebas, la ejecución del código mostró notables mejoras. Al usar más o menos 63 señuelos con Triptych, el proceso se ejecuta 10% más rápido que el usar 10 señuelos con CLSAG. Estos resultados muestran claras mejoras a Monero que también serán prácticas al momento de la integración.

Sin embargo, aún queda trabajo para que Triptych ingrese al código base de Monero ya que se requiere de una validación exhaustiva. Aunque el documento del algoritmo de Triptych ha sido revisado y aceptado por el taller internacional ESORICS CBT 2020, Triptych aún puede beneficiarse de las modificaciones e implementaciones en el software que se le hagan a estos algoritmos. La implementación incluso puede ser optimizada aún más para reducir los tiempos de validación. Dedicarle este esfuerzo a Triptych reemplaza el trabajo que se le puede dedicar a otras alternativas.

Una de esas alternativas, vista con buenos ojos, es la versión avanzada de Triptych llamada Arcturus, desarrollada por Sarang Noether. Arcturus reduce aún más el tamaño de las transacciones utilizando una única firma criptográfica de datos agrupada para toda la transacción en vez de una independiente para cada TXO de entrada. Arcturus y Triptych tienen tiempos de validación similares. Lo que se gana en el tamaño de la transacción en Arcturus es un algoritmo que requiere de una suposición matemática que no es necesaria para Triptych.

### _En resumen_

Con Triptych y su extensión Arcturus, Monero tiene una tecnología a la mano con un gran potencial para reducir el crecimiento del tamaño de los datos de las firmas de anillo, de linealmente a escala logarítmica (incluyendo los señuelos utilizados para ocultar al emisor). Si es acogido, le permitiría al número de señuelos incrementarse sin incrementar el tamaño de la cadena de bloques o sin incrementar las validaciones que tenga que hacer la máquina. La tecnología de Triptych, mantiene el progreso ininterrumpido de Monero, exhibiendo lo posible y protegiendo la privacidad y la libertad de sus usuarios.
